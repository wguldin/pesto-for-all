{% comment %}
  Product Card Snippet
  Usage: {% render 'product-card', product: product, image_size: '400x400', show_description: false %}
  
  Parameters:
  - product: The product object to display
  - image_size: Image dimensions (default: '400x400')
  - show_description: Whether to show product description (default: false)
  - card_class: Additional CSS class for the card (default: 'product-card')
{% endcomment %}

{% assign image_size = image_size | default: '400x400' %}
{% assign show_description = show_description | default: false %}
{% assign card_class = card_class | default: 'product-card' %}

<div class="{{ card_class }}" data-product-id="{{ product.id }}" data-product-url="{{ product.url }}">
  <div class="{{ card_class }}__image">
    {% assign width = image_size | split: 'x' | first %}
    {% assign height = image_size | split: 'x' | last %}
    <img 
      srcset="{{ product.featured_image | image_url: width: 300, height: 300 }} 300w,
              {{ product.featured_image | image_url: width: 400, height: 400 }} 400w,
              {{ product.featured_image | image_url: width: 600, height: 600 }} 600w,
              {{ product.featured_image | image_url: width: 800, height: 800 }} 800w"
      sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 300px"
      src="{{ product.featured_image | image_url: width: width, height: height }}" 
      alt="{{ product.title }}"
      loading="{% if show_description %}eager{% else %}lazy{% endif %}"
      class="{{ card_class }}__image--primary"
      style="aspect-ratio: 1 / 1"
    >
    {% if product.images.size > 1 %}
      <img 
        srcset="{{ product.images[1] | image_url: width: 300, height: 300 }} 300w,
                {{ product.images[1] | image_url: width: 400, height: 400 }} 400w,
                {{ product.images[1] | image_url: width: 600, height: 600 }} 600w,
                {{ product.images[1] | image_url: width: 800, height: 800 }} 800w"
        sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, (max-width: 1024px) 33vw, 300px"
        src="{{ product.images[1] | image_url: width: width, height: height }}" 
        alt="{{ product.title }}"
        loading="lazy"
        class="{{ card_class }}__image--secondary"
        style="aspect-ratio: 1 / 1"
      >
    {% endif %}
  </div>
  
  <div class="{{ card_class }}__content">
    <h3 class="{{ card_class }}__title">
      <a href="{{ product.url }}">{{ product.title }}</a>
    </h3>
  
    {% if show_description and product.description != blank %}
      <div class="product-description">
        {{ product.description }}
      </div>
    {% endif %}

    {% if product.available %}
      <div class="{{ card_class }}__form">
        <form class="product-form" data-product-form="{{ product.id }}">
          {% if product.has_only_default_variant %}
            <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
            <button 
              type="submit" 
              class="button add-to-cart product-card__button"
              data-variant-id="{{ product.selected_or_first_available_variant.id }}"
            >
              <span>Quick Add</span>
              <span>&nbsp;â€¢&nbsp;</span>
              <span>
                {% if product.compare_at_price > product.price %}
                  {{ product.price | money }}
                {% else %}
                  {{ product.price | money }}
                {% endif %}
              </span>
            </button>
          {% else %}
            <a 
              href="{{ product.url }}" 
              class="button product-card__button"
            >
              Get Started
            </a>
          {% endif %}
        </form>
      </div>
    {% else %}
      <div class="{{ card_class }}__unavailable">
        <span class="{{ card_class }}__sold-out">Sold Out</span>
      </div>
    {% endif %}
  </div>

</div> 